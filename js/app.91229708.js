(function(e){function t(t){for(var o,s,a=t[0],c=t[1],l=t[2],d=0,p=[];d<a.length;d++)s=a[d],Object.prototype.hasOwnProperty.call(r,s)&&r[s]&&p.push(r[s][0]),r[s]=0;for(o in c)Object.prototype.hasOwnProperty.call(c,o)&&(e[o]=c[o]);u&&u(t);while(p.length)p.shift()();return i.push.apply(i,l||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],o=!0,a=1;a<n.length;a++){var c=n[a];0!==r[c]&&(o=!1)}o&&(i.splice(t--,1),e=s(s.s=n[0]))}return e}var o={},r={app:0},i=[];function s(t){if(o[t])return o[t].exports;var n=o[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=e,s.c=o,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)s.d(n,o,function(t){return e[t]}.bind(null,o));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],c=a.push.bind(a);a.push=t,a=a.slice();for(var l=0;l<a.length;l++)t(a[l]);var u=c;i.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"034f":function(e,t,n){"use strict";var o=n("85ec"),r=n.n(o);r.a},"17cb":function(e,t,n){"use strict";var o=n("f2bc"),r=n.n(o);r.a},"2ace":function(e,t,n){"use strict";var o=n("f966"),r=n.n(o);r.a},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var o=n("2b0e"),r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("router-view")],1)},i=[],s={name:"app"},a=s,c=(n("034f"),n("2877")),l=Object(c["a"])(a,r,i,!1,null,null,null),u=l.exports,d=n("5f5b"),p=n("b1e0"),f=n("8c4f"),g=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"nearly"},[n("b-row",[n("b-col",[n("input",{directives:[{name:"model",rawName:"v-model",value:e.searchQuery,expression:"searchQuery"}],staticClass:"search",attrs:{type:"text",placeholder:"Search..."},domProps:{value:e.searchQuery},on:{input:function(t){t.target.composing||(e.searchQuery=t.target.value)}}})]),n("router-link",{attrs:{to:"/logout.html"}},[e._v("Logout")])],1),e.isMobile()?n("b-row",[e.selected?n("b-col",{staticClass:"scroll"},[e.edit?n("div",[n("div",{staticClass:"d-flex justify-content-around"},[n("b-button",{on:{click:function(t){e.selected=""}}},[e._v(" < Back")]),n("b-button",{on:{click:e.save}},[e._v("Save"+e._s(e.dots))]),n("b-button",{on:{click:e.newr}},[e._v("New")])],1),n("h3",[n("input",{directives:[{name:"model",rawName:"v-model",value:e.recipe.title,expression:"recipe.title"}],domProps:{value:e.recipe.title},on:{input:function(t){t.target.composing||e.$set(e.recipe,"title",t.target.value)}}})]),n("v-select",{attrs:{options:e.cats,taggable:"","create-option":function(e){return e}},model:{value:e.recipe.category,callback:function(t){e.$set(e.recipe,"category",t)},expression:"recipe.category"}}),n("textarea",{directives:[{name:"model",rawName:"v-model",value:e.recipe.body,expression:"recipe.body"}],domProps:{value:e.recipe.body},on:{input:function(t){t.target.composing||e.$set(e.recipe,"body",t.target.value)}}})],1):n("div",[n("div",{staticClass:"d-flex justify-content-around"},[n("b-button",{on:{click:function(t){e.selected=""}}},[e._v(" < Back")]),n("b-button",{on:{click:e.newr}},[e._v("New")]),n("b-button",{on:{click:function(t){e.edit=!0}}},[e._v("Edit")])],1),n("h1",[e._v(e._s(e.recipe.title))]),n("pre",[e._v(e._s(e.recipe.body))])])]):n("b-col",{staticClass:"scroll"},[n("List",{ref:"list",attrs:{selected:e.selected,items:e.list}})],1)],1):n("b-row",[n("b-col",{staticClass:"scroll",attrs:{sm:"5"}},[n("List",{ref:"list",attrs:{selected:e.selected,items:e.list},on:{"select-recipe":e.selectrecipe}})],1),n("b-col",{staticClass:"scroll",attrs:{sm:"7"},on:{drop:e.dropHandler}},[n("div",{staticClass:"d-flex justify-content-around"},[n("b-button",{on:{click:e.save}},[e._v("Save"+e._s(e.dots))]),n("b-button",{on:{click:e.del}},[e._v("Delete")]),n("b-button",{on:{click:e.newr}},[e._v("New")])],1),n("h1",[n("input",{directives:[{name:"model",rawName:"v-model",value:e.recipe.title,expression:"recipe.title"}],domProps:{value:e.recipe.title},on:{input:function(t){t.target.composing||e.$set(e.recipe,"title",t.target.value)}}})]),n("v-select",{attrs:{options:e.cats,taggable:"","create-option":function(e){return e}},model:{value:e.recipe.category,callback:function(t){e.$set(e.recipe,"category",t)},expression:"recipe.category"}}),n("textarea",{directives:[{name:"model",rawName:"v-model",value:e.recipe.body,expression:"recipe.body"}],attrs:{rows:"30"},domProps:{value:e.recipe.body},on:{input:function(t){t.target.composing||e.$set(e.recipe,"body",t.target.value)}}})],1)],1)],1)},h=[],v=(n("a623"),n("4de4"),n("caad"),n("4fad"),n("c1f9"),n("b64b"),n("d3b7"),n("ac1f"),n("25f0"),n("2532"),n("5319"),n("1276"),n("3835")),m={cognitoInfo:{},token:"",loggedIn:!1,loadingState:!0,errorLoadingState:!1};function b(e){m.loggedIn=e}function y(){m.loggedIn=!1,m.token="",m.cognitoInfo={},console.log("saved lo",m),localStorage.setItem("recipelogin",JSON.stringify(m))}function w(e){m.cognitoInfo=e}function k(e){m.token=e,console.log("saved token",m),localStorage.setItem("recipelogin",JSON.stringify(m))}function _(){m=JSON.parse(localStorage.getItem("recipelogin")),console.log("loaded",m)}function I(){return m.token}var S={state:m,setLoggedIn:b,setLoggedOut:y,setCognitoInfo:w,setToken:k,getToken:I,load:_},A=n("bc3a"),O=n.n(A),C=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",e._l(e.catd,(function(t,o){return n("div",{key:o},[n("h5","undefined"!=o?[e._v(e._s(o))]:[e._v("Uncategorised")]),e._l(t,(function(t){return n("div",{key:t.key,staticClass:"listitem",class:{selected:e.selected==t.key},attrs:{id:t.key},on:{click:function(n){return e.select(t.key)}}},[t.image?n("img",{attrs:{src:t.image}}):n("img",{attrs:{width:"44",height:"44",src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8Xw8AAoMBgDTD2qgAAAAASUVORK5CYII="}}),e._v(" "+e._s(t.title)+" ")])}))],2)})),0)},x=[],T=(n("d81d"),n("2ef0")),$=n.n(T),j={name:"List",data:function(){return{catd:[]}},props:{items:{default:{}},selected:{default:""}},created:function(){this.catd=this.categorised()},methods:{categorised:function(){var e=$.a.map(this.items,(function(e,t){return e.key=t,e}));return $.a.groupBy(e,"category")},select:function(e){this.$root.$emit("select-recipe",e)},update:function(){this.catd=this.categorised(),this.$forceUpdate()}}},L=j,E=(n("17cb"),Object(c["a"])(L,C,x,!1,null,"37517814",null)),P=E.exports,U=n("4a7a"),N=n.n(U),Q=(n("6dfc"),{name:"Home",components:{List:P,vSelect:N.a},watch:{searchQuery:function(e){this.recalc(e),this.$refs.list.update()},recipe:{handler:function(e){var t=this.selected;""==t&&(t=this.random()),""!=e.title?(this.recipes[t]=e,this.selected=t):this.recipes,setTimeout((function(){var e=document.getElementById(t);void 0!=e&&null!=e&&e.scrollIntoView(!0)}),200),this.$refs.list.update()},deep:!0}},computed:{cats:function(){var e=$.a.keyBy(this.recipes,"category");return Object.keys(e)}},data:function(){return{edit:!1,searchQuery:"",selected:"",list:{},dots:"",recipe:{title:"",body:"",image:""},recipes:{loading:{category:"",title:"Loading..."}}}},mounted:function(){this.$root.$on("select-recipe",this.selectrecipe),S.load(),this.load(),this.recalc(this.searchQuery),this.$refs.list.update()},methods:{random:function(){return(new Date).getTime().toString(16)+"#"+Math.random().toString(36).replace(/[^a-z0-9]+/g,"").substr(0,5)},newr:function(){var e=this.random();this.recipe={title:"",body:"",image:""},this.recipes[e]=this.recipe,console.log(this.recipes),this.selected=e,this.edit=!0,this.$refs.list.update()},reset:function(){this.searchQuery="",this.recalc("")},recalc:function(e){this.list=e?Object.fromEntries(Object.entries(this.recipes).filter((function(t){var n=Object(v["a"])(t,2),o=n[0],r=n[1];return void 0!=o&&(void 0!=e&&e.toLowerCase().split(" ").every((function(e){return void 0==r.body?r.title.toLowerCase().includes(e):r.title.toLowerCase().includes(e)||r.body.toLowerCase().includes(e)})))}))):this.recipes},selectrecipe:function(e){this.edit=!1,this.selected=e,this.recipe=this.recipes[e],this.recalc(this.searchQuery)},nl2br:function(e){return"<"==e[0]?e:e.replace(/\n+/g,"<br/>\n")},isMobile:function(){return!!/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)},load:function(){var e=this;O.a.get("https://p4z8g78mya.execute-api.eu-west-2.amazonaws.com/prod/recipes",{headers:{Authorization:S.getToken(),"Content-Type":"application/json"}}).then((function(t){e.recipes=t.data,e.recalc(e.searchQuery);var n=e.$refs.list;console.log("loaded",n),setTimeout(n.update,200)})).catch((function(e){console.log("error",e)}))},del:function(){this.recipe={title:"",body:"",image:""},delete this.recipes[this.selected],this.selected="",this.recalc(this.searchQuery),this.$refs.list.update()},save:function(){var e=this;this.edit=!1,this.dots="...",O.a.put("https://p4z8g78mya.execute-api.eu-west-2.amazonaws.com/prod/recipes",this.recipes,{headers:{Authorization:S.getToken(),"Content-Type":"application/json"}}).then((function(t){e.dots="",console.log("return",t)})).catch((function(t){e.dots="...error",console.log("error",t)}))},dropHandler:function(e){var t=this;void 0!=e.preventDefault&&e.preventDefault();var n=e.dataTransfer.getData("text/html");if(void 0!=n){var o=document.createElement("div");o.innerHTML=n,console.log(o.lastChild.src);var r=new Image;r.crossOrigin="anonymous",r.onload=function(){var e=document.createElement("canvas");e.width=44,e.height=44;var n=e.getContext("2d");n.drawImage(r,0,0,44,44),t.recipe["image"]=e.toDataURL(),t.$refs.list.update()},r.src=o.lastChild.src}0!=e.dataTransfer.files.length&&console.log("Dropped:",e.dataTransfer.files[0])}}}),z=Q,B=(n("2ace"),Object(c["a"])(z,g,h,!1,null,"70427098",null)),D=B.exports,M=n("0a89"),R={getUserInfo:function(){var e=Z.auth.getSignInUserSession().getAccessToken().jwtToken,t="https://"+Z.auth.getAppWebDomain()+"/oauth2/userInfo",n={headers:{Authorization:"Bearer "+e}};return O.a.get(t,n).then((function(e){return e.data}))}},q="60bf861o2iqcauorgqq7t5dkl1",J="recipebook.auth.eu-west-2.amazoncognito.com",H="https://recipe.wizguild.com/oauth.html",K="eu-west-2_KmsrwWT9b",V="https://recipe.wizguild.com/logout.html",W={ClientId:q,AppWebDomain:J,TokenScopesArray:["openid","email"],RedirectUriSignIn:H,RedirectUriSignOut:V,UserPoolId:K},G=new M["a"](W);function F(){var e="CognitoIdentityServiceProvider."+G.getClientId(),t=G.signInUserSession.getAccessToken().getUsername();console.log("TOKEN:",G.signInUserSession.getIdToken().getJwtToken());var n=e+"."+t+".userInfo";return n}G.userhandler={onSuccess:function(e){console.log("On Success result",e),S.setLoggedIn(!0),S.setToken(e.getIdToken().getJwtToken()),R.getUserInfo().then((function(e){fe.push("/")}))},onFailure:function(e){S.setLoggedOut(),fe.go({path:"/error",query:{message:"Login failed due to "+e}})}};var X=new M["b"],Y=X.getStorage(),Z={auth:G,login:function(){G.getSession()},logout:function(){if(G.isUserSignedIn()){var e=this.getUserInfoStorageKey();G.signOut(),Y.removeItem(e)}},getUserInfoStorageKey:F},ee=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"row"},[n("div",{staticClass:"col"},[n("h2",[e._v("Logged Out successfully")]),n("router-link",{attrs:{to:"/login"}},[e._v("Login")])],1)])},te=[],ne={mounted:function(){}},oe=ne,re=Object(c["a"])(oe,ee,te,!1,null,null,null),ie=re.exports,se=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"alert alert-danger"},[e._v(" "+e._s(e.message)+" ")])},ae=[],ce={data:function(){return{message:""}},mounted:function(){this.message=this.$route.query.message}},le=ce,ue=Object(c["a"])(le,se,ae,!1,null,null,null),de=ue.exports;function pe(e,t,n){Z.auth.isUserSignedIn()?R.getUserInfo().then((function(e){console.log("LOGIN RESPONSE",e),S.setLoggedIn(!0),S.setCognitoInfo(e),n()})):(S.setLoggedIn(!1),n({path:"/login",query:{redirect:e.fullPath}}))}o["default"].use(f["a"]);var fe=new f["a"]({mode:"history",base:"/",routes:[{path:"/",name:"Home",component:D,beforeEnter:pe},{path:"/login",beforeEnter:function(e,t,n){Z.auth.getSession()}},{path:"/oauth.html",beforeEnter:function(e,t,n){var o=window.location.href;Z.auth.parseCognitoWebResponse(o)}},{path:"/logout.html",component:ie,beforeEnter:function(e,t,n){Z.logout(),n()}},{path:"/error",component:de}]});n("f9e3"),n("2dd8");o["default"].use(d["a"]),o["default"].use(p["a"]),o["default"].config.productionTip=!1,new o["default"]({render:function(e){return e(u)},router:fe}).$mount("#app")},"85ec":function(e,t,n){},f2bc:function(e,t,n){},f966:function(e,t,n){}});
//# sourceMappingURL=app.91229708.js.map